document.addEventListener("DOMContentLoaded",(function(){function e(e){var t=-1,n=e.previousElementSibling,o=document.querySelector(".container__suggestions"),i=document.getElementById("tags-list").value.split(", ");function l(){var t,n=e.value;for(t=e.selectionStart-1;t>=0&&!/\s/.test(n[t]);)t--;return t}function a(t){var n=e.value,o=e.selectionStart,i=l(),a=n.substring(0,i+1)+t+n.substring(o);e.value=a,e.focus(),e.selectionStart=e.selectionEnd=i+1+t.length}function c(e,t,n){return Math.min(Math.max(e,t),n)}e.addEventListener("scroll",(function(){n.scrollTop=e.scrollTop})),e.addEventListener("input",(function(){var t,c,r,d,s,u,m,p,y=e.value,f=e.selectionStart,v=l();""!==(t=y.substring(v+1,f))&&0!==(c=i.filter((function(e){return e.toLowerCase().indexOf(t.toLowerCase())>-1}))).length?(m=y.substring(0,f),p=y.substring(f),r=document.createTextNode(m),d=document.createTextNode(p),(s=document.createElement("span")).innerHTML="&nbsp;",n.innerHTML="",n.append(r,s,d),u=s.getBoundingClientRect(),o.style.top=`${u.top+u.height}px`,o.style.left=`${u.left}px`,o.innerHTML="",c.forEach((function(e){var t=document.createElement("div");t.innerText=e,t.classList.add("container__suggestion"),t.addEventListener("click",(function(){a(this.innerText),o.style.display="none"})),o.appendChild(t)})),o.style.display="block"):o.style.display="none"})),e.addEventListener("keydown",(function(e){var n,i;if(["ArrowDown","ArrowUp","Enter","Escape"].includes(e.key)&&0!==(i=(n=o.querySelectorAll(".container__suggestion")).length)&&"none"!==o.style.display)switch(e.preventDefault(),e.key){case"ArrowDown":n[c(0,t,i-1)].classList.remove("container__suggestion--focused"),n[t=c(0,t+1,i-1)].classList.add("container__suggestion--focused");break;case"ArrowUp":n[c(0,t,i-1)].classList.remove("container__suggestion--focused"),n[t=c(0,t-1,i-1)].classList.add("container__suggestion--focused");break;case"Enter":e.stopPropagation(),a(n[t].innerText),o.style.display="none";break;case"Escape":o.style.display="none"}}))}function t(e,t){var n;"object"==typeof t&&(t=this.getId(t)),n=new URLSearchParams({action:"quick-edit-attachment",post_type:"attachment",id:t,edit_date:"true"}),e.querySelectorAll('input:not([readonly=""]), select, textarea').forEach((function(e){"media_category[]"===e.name?e.checked&&n.append(e.name,e.value):n.append(e.name,e.value)})),fetch(ajaxurl,{method:"POST",body:n,credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(e){var n;document.getElementById("post-"+t).innerHTML=e.data,n="post-"+t,document.querySelectorAll(".hide-column-tog").forEach((function(e){!1===e.checked&&document.getElementById(n).querySelector("."+e.value).classList.add("hidden")})),wp.a11y.speak(wp.i18n.__("Changes saved."))}))["catch"]((function(){var t=e.querySelector(".inline-edit-save .notice-error"),n=t.querySelector(".error");t.classList.remove("hidden"),n.textContent=wp.i18n.__("Error while saving the changes."),wp.a11y.speak(wp.i18n.__("Error while saving the changes."))}))}window.findPosts={open:function(e,t){var n=document.querySelector(".ui-find-overlay");return null==n&&((n=document.createElement("div")).className="ui-find-overlay",document.body.append(n),findPosts.overlay()),n.style.display="",e&&t&&(document.getElementById("affected").setAttribute("name",e),document.getElementById("affected").value=t),document.getElementById("find-posts").style.display="",document.getElementById("find-posts-input").addEventListener("keyup",(function(e){this.focus(),"Escape"===e.key&&findPosts.close()})),findPosts.send(),!1},close:function(){document.getElementById("find-posts-response").innerHTML="",document.getElementById("find-posts").style.display="none",document.querySelector(".ui-find-overlay").style.display="none"},overlay:function(){document.querySelector(".ui-find-overlay").addEventListener("click",(function(){findPosts.close()}))},send:function(){var e={ps:document.getElementById("find-posts-input").value,action:"find_posts",_ajax_nonce:document.getElementById("_ajax_nonce").value},t=document.querySelector(".find-box-search .spinner");t.classList.add("is-active"),fetch(ajaxurl,{method:"POST",body:new URLSearchParams(e),credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(e){t.classList.remove("is-active"),document.getElementById("find-posts-response").innerHTML=e.data}))["catch"]((function(){t.classList.remove("is-active"),document.getElementById("find-posts-response").textContent=wp.i18n.__("An error has occurred. Please reload the page and try again.")}))}};var n,o,i=document.getElementById("wp-media-grid"),l=document.getElementById("upload-category"),a=document.getElementById("quick-edit-update"),c=null;if(null!=i&&window.wp&&window.wp.media){n=_wpMediaGridSettings;var r=window.wp.media({frame:"manage",container:i,library:n.queryVars}).open();i.dispatchEvent(new CustomEvent("wp-media-grid-ready",{detail:r}))}else{document.getElementById("find-posts-submit").addEventListener("click",(function(e){for(var t=!1,n=document.querySelectorAll('#find-posts-response input[type="radio"]'),o=0,i=n.length;o<i;o++)if(n[o].checked){t=!0;break}!1===t&&e.preventDefault()}),!1),document.getElementById("find-posts-input").addEventListener("keydown",(function(e){"Enter"==e.key&&(e.preventDefault(),findPosts.send())}),!1),document.getElementById("find-posts-search").addEventListener("click",findPosts.send),document.getElementById("find-posts-close").addEventListener("click",findPosts.close);var d=document.getElementById("doaction");d&&d.addEventListener("click",(function(n){var o,i,l,r,d,s,u,m,p,y="",f=document.getElementById("quick-edit"),v=document.getElementById("bulk-edit"),g=document.querySelector('select[name="action"]').value,h=0,E=0,b=[...document.querySelector(".widefat thead tr").children];v.style.display="none",document.body.append(v),f.style.display="none",document.body.append(f),f.querySelector(".inline-edit-save .notice-error").classList.add("hidden"),"-1"===g?(n.preventDefault(),location.href=location.pathname):"attach"===g?(n.preventDefault(),findPosts.open()):"delete"===g?showNotice.warn()||n.preventDefault():"edit"===g&&(n.preventDefault(),i=document.querySelectorAll('tbody th.check-column input[type="checkbox"]'),(m=document.createElement("tr")).className="hidden",i.forEach((function(e){if(e.checked){var t=e.value,n=document.getElementById("post-"+t).querySelector(" .filename").innerHTML||wp.i18n.__("(no title)"),i=wp.i18n.sprintf(wp.i18n.__("Remove &#8220;%s&#8221; from Bulk Edit"),n);1===++h&&(o=document.getElementById("post-"+t)),y+='<li class="ntdelitem" name="attachment[]" value="'+t+'"><button type="button" id="_'+t+'" class="button-link ntdelbutton"><span class="screen-reader-text">'+i+'</span></button><span class="ntdeltitle" aria-hidden="true">'+n+"</span></li>"}})),b.forEach((function(e){e.className.includes("hidden")||E++})),v.querySelector("td").setAttribute("colspan",E),f.querySelector("td").setAttribute("colspan",E),h<1?(v.style.display="none",document.body.append(v),f.style.display="none",document.body.append(f)):1===h?(f.querySelectorAll('input:not(#_inline_edit_attachment):not([name="media_category[]"]), select, textarea').forEach((function(e){e.value=""})),document.getElementById("the-list").prepend(m),f.dataset.id=o.id,o.before(f),f.classList.add("inline-editor"),f.style.display="",o.style.display="none",f.scrollIntoView({behavior:"smooth"}),r=o.querySelector(".column-author a").textContent,f.querySelectorAll("#quick-author option").forEach((function(e){e.textContent===r&&(document.getElementById("quick-author").value=e.value,e.setAttribute("selected","selected"))})),d=o.querySelectorAll(".column-taxonomy-media_category a"),s=[],d.forEach((function(e){s.push(e.textContent)})),f.querySelectorAll(".category-checklist li").forEach((function(e){s.includes(e.querySelector("label").textContent)?e.querySelector("input").checked=!0:e.querySelector("input").checked=!1})),u=o.querySelector(".column-taxonomy-media_post_tag a")?o.querySelector(".column-taxonomy-media_post_tag").textContent:"",e(f.querySelector("textarea")),l=o.querySelector(".column-date time").getAttribute("datetime").split("/"),f.querySelector('[name="mm"]').value=l[1],f.querySelector('[name="jj"]').value=l[2],f.querySelector('[name="aa"]').value=l[0],f.querySelector('[name="post_title"]').value=o.querySelector(".column-title strong a").textContent.trim(),f.querySelector('[name="post_name"]').value=o.querySelector(".column-title .row-actions .copy-attachment-url").dataset.clipboardText,f.querySelector("#quick-media-tags").value=u,f.querySelector('[name="alt"]').value=o.querySelector(".column-alt").textContent,f.querySelector('[name="post_excerpt"]').value=o.querySelector(".column-caption").textContent,f.querySelector('[name="post_content"]').value=o.querySelector(".column-desc").textContent,null===c&&(c=function(){!function(e,n){for(var o=document.querySelector(".inline-edit-wrapper").querySelectorAll("input[pattern]"),i=!0,l=0,r=o.length;l<r;l++)if(!o[l].checkValidity()){o[l].reportValidity(),i=!1;break}if(i){var d=n.id.replace("post-","");t(e,d),document.getElementById("bulk-action-selector-top").value="-1",document.getElementById("bulk-action-selector-bottom").value="-1",setTimeout((function(){n.style.display="",e.style.display="none",document.body.append(e)}),100),null!==c&&(a.removeEventListener("click",c),c=null)}}(f,o)},a.addEventListener("click",c))):(document.querySelectorAll("tr").forEach((function(e){"none"===e.style.display&&(e.style.display="")})),document.getElementById("the-list").prepend(v),document.getElementById("the-list").prepend(m),v.classList.add("inline-editor"),v.style.display="",o.style.display="",e(v.querySelector("textarea")),document.getElementById("bulk-titles").innerHTML='<ul id="bulk-titles-list" role="list">'+y+"</ul>",v.scrollIntoView({behavior:"smooth"}),document.querySelectorAll("#bulk-titles .ntdelbutton").forEach((function(e){e.addEventListener("click",(function(){var t=e.id,n=e.parentNode,o=n.previousElementSibling?n.previousElementSibling.querySelector(".ntdelbutton"):null,i=n.nextElementSibling?n.nextElementSibling.querySelector(".ntdelbutton"):null;document.querySelector('table.widefat input[value="'+t.replace("_","")+'"]').checked=!1,document.getElementById(t).parentNode.remove(),wp.a11y.speak(wp.i18n.__("Item removed."),"assertive"),null!==i?i.focus():null!==o?o.focus():(m.remove(),document.getElementById("bulk-titles-list").remove(),v.style.display="none",document.body.append(v),wp.a11y.speak(wp.i18n.__("All selected items have been removed. Select new items to use Bulk Actions.")))}))})),document.getElementById("bulk-edit-update").addEventListener("click",(function(){m.remove()}))),document.querySelector(".inline-edit-wrapper").setAttribute("tabindex","-1"),document.querySelector(".inline-edit-wrapper").focus(),(p=document.querySelector(".inline-edit-save .cancel")).addEventListener("click",(function(){null!=m&&m.remove(),o.style.display="",document.getElementById("bulk-action-selector-top").value="-1",document.getElementById("bulk-action-selector-bottom").value="-1",v.style.display="none",document.body.append(v),f.style.display="none",document.body.append(f),null!==c&&(a.removeEventListener("click",c),c=null)})),f.addEventListener("keydown",(function(e){"Escape"===e.key&&p.click()})),v.addEventListener("keydown",(function(e){"Escape"===e.key&&p.click()})))})),document.querySelectorAll(".find-box-inside tr").forEach((function(e){e.addEventListener("click",(function(){e.querySelector(".found-radio input").checked=!0}))})),document.querySelectorAll(".copy-attachment-url.media-library").forEach((function(e){e.addEventListener("click",(function(){var t=e.getAttribute("data-clipboard-text"),n=document.createElement("input");navigator.clipboard?navigator.clipboard.writeText(t):(document.body.append(n),n.value=t,n.select(),document.execCommand("copy")),clearTimeout(o),e.nextElementSibling.classList.remove("hidden"),n.remove(),o=setTimeout((function(){e.nextElementSibling.classList.add("hidden")}),3e3),wp.a11y.speak(wp.i18n.__("The file URL has been copied to your clipboard"))}))}))}document.body.className.includes("upload-php")&&null==i&&null!=l&&(l.addEventListener("change",(function(e){var t,n=document.querySelector(".is-dismissible"),o=new URLSearchParams({action:"media-cat-upload",option:"media_cat_upload_folder",media_cat_upload_value:e.target.value,media_cat_upload_nonce:document.getElementById("media_cat_upload_nonce").value});null!=n&&n.remove(),fetch(ajaxurl,{method:"POST",body:o,credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(n){n.success&&(""==n.data.value?((t=document.createElement("div")).id="message",t.className="notice notice-error is-dismissible",t.innerHTML="<p>"+n.data.message+'</p><button class="notice-dismiss" type="button"></button>',document.querySelector(".page-title-action").after(t)):((t=document.createElement("div")).id="message",t.className="updated notice notice-success is-dismissible",t.innerHTML="<p>"+n.data.message+'</p><button class="notice-dismiss" type="button"></button>',document.querySelector(".page-title-action").after(t),l.childNodes.forEach((function(t){t.value===e.target.value?t.setAttribute("selected",!0):t.removeAttribute("selected")}))))}))["catch"]((function(e){(t=document.createElement("div")).id="message",t.className="notice notice-error is-dismissible",t.innerHTML="<p>"+e+'</p><button class="notice-dismiss" type="button"></button>',document.querySelector(".page-title-action").after(t)}))})),document.addEventListener("click",(function(e){"notice-dismiss"===e.target.className&&document.querySelector(".is-dismissible").remove()})))}));