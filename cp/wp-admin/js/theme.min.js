document.addEventListener("DOMContentLoaded",(function(){var e,t,r,a=1,o=0,l="browse",n="popular",c=[],s=new URLSearchParams(window.location.search),i=document.getElementById("theme-modal"),u=document.querySelector(".theme-install-overlay"),d=u?u.querySelector(".theme-install").textContent:"",m=document.querySelector(".theme-install-php #wpfooter"),h=document.querySelectorAll(".filter-group-feature input"),y=document.querySelector(".theme-install-php #wp-filter-search-input");function p(){i.close(),document.getElementById(i.dataset.highlightedTheme).focus(),i.querySelector(".left.dashicons.dashicons-no").disabled=!1,i.querySelector(".right.dashicons.dashicons-no").disabled=!1,S()}function S(){i.querySelector("#theme-modal-insert-container").remove(),i.dataset.highlightedTheme="",history.replaceState(null,null,location.href.split("?")[0])}function q(){document.body.style.overflow="",u.close(),document.getElementById(u.querySelector(".theme-install-container").dataset.id).focus(),u.querySelector(".previous-theme").disabled=!1,u.querySelector(".next-theme").disabled=!1,g()}function g(){u.classList.add("expanded"),u.classList.remove("collapsed"),u.querySelector(".wp-full-overlay-main").style.width="calc(100% - 300px)",u.querySelector(".theme-install-container").dataset.id="",u.querySelector(".activate")&&(u.querySelector(".activate").className="button button-primary theme-install"),u.querySelector(".theme-install").href="",u.querySelector(".theme-name").textContent="",u.querySelector(".theme-by").textContent="",u.querySelector(".theme-screenshot img").src="",u.querySelector(".theme-rating").innerHTML=' <a class="num-ratings" href=""></a>',u.querySelector(".theme-version").textContent="",u.querySelector(".theme-description").textContent="",u.querySelector("iframe").src="",history.replaceState(null,null,location.href.split("?")[0])}function v(){var e=document.querySelector(".themes"),t=new URLSearchParams({action:"query-themes","request[per_page]":100,"request[page]":a});"browse"===l?t.append("request[browse]",n):"search"===l?t.append("request[search]",n):"tag"===l&&t.append("request[tag]",c),fetch(ajaxurl,{method:"POST",body:t,credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(t){1===a&&(e.innerHTML=""),document.querySelector(".filter-count .theme-count").textContent=t.data.count,e.insertAdjacentHTML("beforeend",t.data.html),b(document.querySelectorAll(".themes li:not( .add-new-theme )"))}))["catch"]((function(e){console.error(_wpThemeSettings.error,e)}))}function b(e){e.forEach((function(t){t.addEventListener("mouseover",(function(){e.forEach((function(e){e.querySelector(".more-details").style.opacity="0",e.querySelector(".theme-actions").style.opacity="0"})),t.querySelector(".more-details").style.opacity="1",t.querySelector(".theme-actions").style.opacity="1",t.querySelector(".theme-actions").style.display="block"})),t.addEventListener("touchenter",(function(){e.forEach((function(e){e.querySelector(".more-details").style.opacity="0",e.querySelector(".theme-actions").style.opacity="0"})),t.querySelector(".more-details").style.opacity="1",t.querySelector(".theme-actions").style.opacity="1",t.querySelector(".theme-actions").style.display="block"})),t.addEventListener("mouseout",(function(){t.querySelector(".more-details").style.opacity="0",t.querySelector(".theme-actions").style.opacity="0",t.querySelector(".theme-actions").style.display="none"})),t.addEventListener("touchleave",(function(){t.querySelector(".more-details").style.opacity="0",t.querySelector(".theme-actions").style.opacity="0",t.querySelector(".theme-actions").style.display="none"}))}))}s.has("theme")?null!=(r=s.get("theme"))&&null!=document.getElementById(r)&&setTimeout((function(){document.getElementById(r).querySelector(".more-details").click()})):document.body.className.includes("themes-php")&&s.has("search")&&(document.getElementById("wp-filter-search-input").value=s.get("search"),setTimeout((function(){document.getElementById("wp-filter-search-input").dispatchEvent(new KeyboardEvent("keyup",{key:"Enter"}))}))),document.querySelectorAll("li").forEach((function(e){var t;e.querySelectorAll(".notice-error").length>1&&(t=e.querySelectorAll(".notice-error")[1],e.querySelector(".notice-error").insertAdjacentHTML("beforeend",t.innerHTML),t.remove())})),m&&new IntersectionObserver((function(e){e.forEach((e=>{e.isIntersecting&&(a++,v())}))}),{rootMargin:"50%",threshold:0}).observe(m),b(document.querySelectorAll(".themes li:not( .add-new-theme )")),document.addEventListener("keydown",(function(e){i&&i.open?"Escape"===e.key?p():"ArrowLeft"===e.key||"ArrowUp"===e.key?(e.preventDefault(),i.querySelector(".left.dashicons.dashicons-no").click()):"ArrowRight"!==e.key&&"ArrowDown"!==e.key||(e.preventDefault(),i.querySelector(".right.dashicons.dashicons-no").click()):u&&u.open&&("Escape"===e.key?q():"ArrowLeft"===e.key||"ArrowUp"===e.key?(e.preventDefault(),u.querySelector(".previous-theme").click()):"ArrowRight"!==e.key&&"ArrowDown"!==e.key||(e.preventDefault(),u.querySelector(".next-theme").click()))})),document.addEventListener("click",(function(r){var m,y,b,f,w,A,x=r.target.closest(".theme"),E=document.querySelectorAll(".themes li:not( .add-new-theme )"),L=document.querySelector(".themes li"),N=E[parseInt(E.length-1)];i&&"more-details"===r.target.className?(r.preventDefault(),x&&(y=document.getElementById("theme-modal-insert").content.cloneNode(!0),i.querySelector(".theme-wrap").append(y),s.set("theme",x.id),history.replaceState(null,null,"?"+s.toString()),i.dataset.highlightedTheme=x.id,null==(e=document.getElementById(i.dataset.highlightedTheme).previousElementSibling)&&(i.querySelector(".left.dashicons.dashicons-no").disabled=!0),null==(t=document.getElementById(i.dataset.highlightedTheme).nextElementSibling)&&(i.querySelector(".right.dashicons.dashicons-no").disabled=!0),x.querySelector("img")?((m=document.createElement("img")).src=x.querySelector("img").src,m.alt=x.querySelector("img").alt,i.querySelector(".screenshot").append(m)):i.querySelector(".screenshot").classList.add("blank"),x.className.includes("active")&&i.querySelector(".current-label").removeAttribute("hidden"),i.querySelector(".theme-name").textContent=x.querySelector(".theme-name").textContent,i.querySelector(".theme-version").textContent=_wpThemeSettings.l10n.version+" "+x.dataset.version,i.querySelector(".theme-author").innerHTML=x.querySelector(".theme-author").innerHTML,"1"!==x.dataset.compatibleWp&&"1"!==x.dataset.compatiblePhp?i.querySelector(".no-wp-php").removeAttribute("hidden"):"1"!==x.dataset.compatibleWp?i.querySelector(".no-wp").removeAttribute("hidden"):"1"!==x.dataset.compatiblePhp&&i.querySelector(".no-php").removeAttribute("hidden"),x.dataset.hasUpdate&&("1-1"===x.dataset.updateResponse?(i.querySelector(".has-update span").innerHTML=x.dataset.update,i.querySelector(".has-update").removeAttribute("hidden")):(i.querySelector(".incompat-update").removeAttribute("hidden"),"1"!==(b=x.dataset.updateResponse.split("-"))[0]&&"1"!==b[1]?i.querySelector(".incompat-update .no-wp-php").removeAttribute("hidden"):"1"!==b[0]?i.querySelector(".incompat-update .no-wp").removeAttribute("hidden"):"1"!==b[1]&&i.querySelector(".incompat-update .no-php").removeAttribute("hidden"))),x.dataset.autoupdate&&(i.querySelector(".theme-autoupdate").removeAttribute("hidden"),"1"===x.dataset.autoupdateSupported?"1"===x.dataset.autoupdateForced&&i.querySelector(".theme-autoupdate .forced")?i.querySelector(".theme-autoupdate .forced").removeAttribute("hidden"):"1"===x.dataset.autoupdateEnabled&&i.querySelector(".theme-autoupdate .enabled")?(i.querySelector(".theme-autoupdate .enabled").dataset.slug=x.id,i.querySelector(".theme-autoupdate .enabled").removeAttribute("hidden")):i.querySelector(".theme-autoupdate .not-forced")&&i.querySelector(".theme-autoupdate .not-forced").removeAttribute("hidden"):i.querySelector(".theme-autoupdate .no-auto")&&(i.querySelector(".theme-autoupdate .no-auto").dataset.slug=x.id,i.querySelector(".theme-autoupdate .no-auto").removeAttribute("hidden"))),x.dataset.hasUpdate&&"1"===x.dataset.autoupdateSupported&&"1"===x.dataset.autoupdateEnabled&&i.querySelector(".theme-autoupdate .auto-update-time").removeAttribute("hidden"),i.querySelector(".theme-description").textContent=x.dataset.description,x.dataset.parent&&(i.querySelector(".parent-theme strong").textContent=x.dataset.parent,i.querySelector(".parent-theme").removeAttribute("hidden")),x.dataset.tags&&(i.querySelector(".theme-tags-span").textContent=x.dataset.tags,i.querySelector(".theme-tags").removeAttribute("hidden")),x.dataset.customize&&i.querySelector(".active-theme .customize")&&(i.querySelector(".active-theme .customize").href=x.dataset.customize),x.className.includes("active")?(i.querySelector(".active-theme a")&&(i.querySelector(".active-theme a").href=x.dataset.customize),i.querySelector(".active-theme").removeAttribute("hidden")):(i.querySelector(".inactive-theme").removeAttribute("hidden"),"1"===x.dataset.compatibleWp&&"1"===x.dataset.compatiblePhp?(x.dataset.activateNonce&&i.querySelector(".inactive-theme a")&&(i.querySelector(".inactive-theme a").href=x.dataset.activateNonce,i.querySelector(".inactive-theme a").classList.add("activate"),i.querySelector(".inactive-theme a").setAttribute("aria-label",_wpThemeSettings.l10n.activate+" "+x.querySelector(".theme-name").textContent),i.querySelector(".inactive-theme a").disabled=!1),i.querySelector(".inactive-theme .load-customize")&&(i.querySelector(".inactive-theme .load-customize").href=x.dataset.customize)):(x.dataset.activateNonce&&i.querySelector(".inactive-theme a")&&(i.querySelector(".inactive-theme a").removeAttribute("href"),i.querySelector(".inactive-theme a").classList.add("disabled"),i.querySelector(".inactive-theme a").setAttribute("aria-label",_wpThemeSettings.l10n.cannot_activate+" "+x.querySelector(".theme-name").textContent)),i.querySelector(".inactive-theme .load-customize")&&(i.querySelector(".inactive-theme .load-customize").removeAttribute("href"),i.querySelector(".inactive-theme .load-customize").classList.add("disabled"),i.querySelector(".inactive-theme .load-customize").classList.remove("load-customize"))),x.dataset.deleteNonce&&i.querySelector(".delete-theme")&&(i.querySelector(".delete-theme").href=x.dataset.deleteNonce,i.querySelector(".delete-theme").setAttribute("aria-label",_wpThemeSettings.l10n["delete"]+" "+x.querySelector(".theme-name").textContent),i.querySelector(".delete-theme").removeAttribute("hidden"))),!x.className.includes("active")&&x.dataset.deleteNonce&&i.querySelector(".delete-theme")?i.querySelector(".delete-theme").style.display="inline-block":i.querySelector(".delete-theme")&&(i.querySelector(".delete-theme").style.display="none"),i.showModal())):"left dashicons dashicons-no"===r.target.className?e?(e===L&&(r.target.disabled=!0),S(),e.querySelector(".more-details").click(),i.querySelector(".right.dashicons.dashicons-no").disabled=!1):r.target.disabled=!0:"right dashicons dashicons-no"===r.target.className?t?(t===N&&(r.target.disabled=!0),S(),t.querySelector(".more-details").click(),i.querySelector(".left.dashicons.dashicons-no").disabled=!1):r.target.disabled=!0:"close dashicons dashicons-no"===r.target.className?p():r.target.className.includes("update-button-link")?(r.target.closest(".update-message").classList.add("updating-message"),w=r.target.closest("li").id,(A=new FormData).append("action","update-theme"),A.append("slug",w),A.append("_ajax_nonce",_wpUpdatesSettings.ajax_nonce),fetch(ajaxurl,{method:"POST",body:A,credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(){var e=document.getElementById(w).querySelector(".update-message");e.innerHTML="<p>"+_wpThemeSettings.l10n.updated+"</p>",e.className="notice inline notice-success notice-alt"}))["catch"]((function(e){console.error(_wpThemeSettings.error,e)}))):document.body.className.includes("theme-install-php")&&("filter-links"===r.target.parentNode.parentNode.className&&"A"===r.target.tagName?(a=1,document.body.classList.remove("show-filters"),document.body.classList.remove("filters-applied"),l="browse",document.querySelectorAll(".filter-links a").forEach((function(e){e.classList.remove("current")})),"browse=popular"===r.target.href.split("?")[1]?(r.preventDefault(),r.target.classList.add("current"),n="popular"):"browse=new"===r.target.href.split("?")[1]&&(r.preventDefault(),r.target.classList.add("current"),n="new"),v(),s["delete"]("search"),s["delete"]("theme"),s.set("browse",n),history.replaceState(null,null,"?"+s.toString())):"apply-filters button"===r.target.className?(a=1,document.body.classList.add("filters-applied"),(f=document.createElement("span")).className="tag",c.forEach((function(e){f.textContent=e,document.querySelector(".filtered-by .tags").append(f.cloneNode(!0))})),v()):"button drawer-toggle"===r.target.className||"button-link edit-filters"===r.target.className?(document.body.classList.add("show-filters"),document.body.classList.remove("filters-applied"),document.querySelector(".filtered-by .tags").innerHTML="",document.querySelector(".filter-drawer").checkVisibility()?document.querySelector(".drawer-toggle").setAttribute("aria-expanded",!1):document.querySelector(".drawer-toggle").setAttribute("aria-expanded",!0)):"clear-filters button"===r.target.className?(h.forEach((function(e){e.checked=!1})),o=0,document.querySelector(".apply-filters span").textContent="",r.target.style.display="none"):"more-details"===r.target.className||"button preview install-theme-preview"===r.target.className?(u.querySelector(".theme-install-container").dataset.id=x.id,s["delete"]("browse"),s["delete"]("search"),s.set("theme",x.id),history.replaceState(null,null,"?"+s.toString()),r.target.parentNode.querySelector(".theme-actions a")&&(u.querySelector(".theme-install").textContent=d,r.target.parentNode.querySelector(".theme-actions a").className.includes("disabled")?(u.querySelector(".theme-install").setAttribute("disabled",!0),u.querySelector(".theme-install").setAttribute("inert",!0),u.querySelector(".theme-install").removeAttribute("href")):(u.querySelector(".theme-install").removeAttribute("disabled"),u.querySelector(".theme-install").removeAttribute("inert"),u.querySelector(".theme-install").href=x.dataset.installNonce)),x.querySelector(".notice-success")&&(u.querySelector(".theme-install").href=x.dataset.activateNonce,u.querySelector(".theme-install").textContent=_wpThemeSettings.l10n.activate,u.querySelector(".theme-install").className="button button-primary activate",x.className.includes("active")&&u.querySelector(".activate").classList.add("disabled")),r.target.previousElementSibling.className.includes("notice-error")&&(u.querySelector(".theme-install")?(u.querySelector(".theme-install").classList.add("disabled"),u.querySelector(".theme-install").setAttribute("disabled",!0),u.querySelector(".theme-install").setAttribute("inert",!0),u.querySelector(".theme-install").removeAttribute("href")):u.querySelector(".activate")&&(u.querySelector(".activate").classList.add("disabled"),u.querySelector(".activate").setAttribute("disabled",!0),u.querySelector(".activate").setAttribute("inert",!0),u.querySelector(".activate").removeAttribute("href"))),u.querySelector(".theme-name").textContent=x.querySelector(".theme-name").textContent,u.querySelector(".theme-by").textContent=x.querySelector(".theme-author").textContent,u.querySelector(".theme-screenshot img").src=x.querySelector(".theme-screenshot img").src,u.querySelector(".theme-rating").insertAdjacentHTML("afterbegin",x.dataset.ratings),u.querySelector(".num-ratings").textContent="("+x.dataset.numRatings+" "+_wpThemeSettings.l10n.ratings+")",u.querySelector(".num-ratings").href="https://wordpress.org/support/theme/"+x.id+"/reviews/",u.querySelector(".theme-version").textContent=_wpThemeSettings.l10n.version+" "+x.dataset.version,u.querySelector(".theme-description").textContent=x.dataset.description,u.querySelector("iframe").src="//wp-themes.com/"+x.id+"/",document.body.style.overflow="hidden",u.showModal(),null==(e=document.getElementById(u.querySelector(".theme-install-container").dataset.id).previousElementSibling)&&(u.querySelector(".previous-theme").disabled=!0),null==(t=document.getElementById(u.querySelector(".theme-install-container").dataset.id).nextElementSibling)&&(u.querySelector(".next-theme").disabled=!0)):"close-full-overlay"===r.target.className?q():"previous-theme"===r.target.className?e?(e===L&&(r.target.disabled=!0),g(),u.querySelector(".next-theme").disabled=!1,setTimeout((function(){e.querySelector(".more-details").click()}),500)):r.target.disabled=!0:"next-theme"===r.target.className?t?(t===N&&(r.target.disabled=!0),g(),u.querySelector(".previous-theme").disabled=!1,setTimeout((function(){t.querySelector(".more-details").click()}),500)):r.target.disabled=!0:r.target.className.includes("collapse")?u.className.includes("expanded")?(u.classList.add("collapsed"),u.classList.remove("expanded"),u.querySelector(".wp-full-overlay-main").style.width="100%"):(u.classList.add("expanded"),u.classList.remove("collapsed"),u.querySelector(".wp-full-overlay-main").style.width="calc(100% - 300px)"):r.target.className.includes("upload-view-toggle")?"block"===document.querySelector(".upload-theme").style.display?(document.querySelector(".upload-theme").style.display="none",r.target.setAttribute("aria-expanded",!1)):(document.querySelector(".upload-theme").style.display="block",r.target.setAttribute("aria-expanded",!0)):r.target.className.includes("theme-install")&&(r.preventDefault(),r.target.textContent=_wpThemeSettings.l10n.installing,r.target.classList.add("updating-message"),r.target.closest(".theme-id-container")?r.target.setAttribute("aria-label","Installing "+r.target.closest(".theme-id-container").querySelector(".theme-name").textContent):r.target.setAttribute("aria-label","Installing "+u.querySelector(".theme-name").textContent),r.target.focus(),wp.a11y.speak(_wpThemeSettings.l10n.installing_wait),function(e){var t=new FormData,r=new URLSearchParams(e).get("theme");t.append("action","install-theme"),t.append("slug",r),t.append("_ajax_nonce",_wpUpdatesSettings.ajax_nonce),fetch(ajaxurl,{method:"POST",body:t,credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(e){var t=e.data.slug,r=document.getElementById(t),a=document.createElement("div");a.className="notice inline notice-success notice-alt",a.innerHTML="<p>"+_wpThemeSettings.l10n.installed+"</p>",r.querySelector(".theme-screenshot").after(a),r.querySelector(".theme-install").textContent=_wpThemeSettings.l10n.activate,r.querySelector(".theme-install").href=r.dataset.activateNonce,r.querySelector(".theme-install").className="button button-primary activate",u&&(q(),r.focus())}))["catch"]((function(e){console.error(_wpThemeSettings.error,e)}))}(r.target.href)))})),h.forEach((function(e){e.addEventListener("change",(function(){var t;l="tag",e.checked?(c.push(e.value),o++):(t=c.indexOf(e.value))>-1&&(c.splice(t,1),o--),o>0?(document.querySelector(".apply-filters span").textContent=o,document.querySelector(".clear-filters").style.display="inline"):(document.querySelector(".apply-filters span").textContent="",document.querySelector(".clear-filters").style.display="none")}))})),y?y.addEventListener("keyup",_.debounce((function(e){e.target.value.length>2&&(a=1,l="search",n=e.target.value,v(),s["delete"]("browse"),s["delete"]("theme"),s.set("search",n),history.replaceState(null,null,"?"+s.toString()))}),500)):document.querySelector(".themes-php #wp-filter-search-input").addEventListener("keyup",_.debounce((function(e){var t=document.querySelectorAll(".themes li"),r=t.length;document.querySelector(".theme-browser.search-loading")&&document.querySelector(".theme-browser.search-loading").classList.remove("search-loading"),"Enter"===e.key||e.target.value.length>2?(t.forEach((function(t){t.id.includes(e.target.value)||(t.style.display="none",r--)})),s.set("search",e.target.value),history.replaceState(null,null,"?"+s.toString())):(t.forEach((function(e){e.style.display=""})),r=t.length-1,history.replaceState(null,null,location.href.split("?")[0])),document.querySelector(".wp-heading-inline .title-count").textContent=r}),500))}));