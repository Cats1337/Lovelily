document.addEventListener("DOMContentLoaded",(function(){var e,t,{FilePond:a}=window,r=document.getElementById("widget-modal");function i(t,a,i){var d=r.querySelectorAll(".widget-modal-grid .selected"),o=t.dataset.id,n=t.getAttribute("aria-label"),l=t.dataset.date,u=t.dataset.filename,s=t.dataset.caption,c=t.dataset.description,m=t.dataset.taxes,p=t.dataset.tags,y=t.dataset.artist,g=t.dataset.album,b=t.dataset.url,v=t.dataset.updateNonce,S=t.dataset.deleteNonce,h=r.querySelectorAll(".widget-modal-right-sidebar input, .widget-modal-right-sidebar textarea, .widget-modal-media-embed input, .widget-modal-media-embed textarea"),q=r.querySelectorAll(".widget-modal-right-sidebar select, .widget-modal-media-embed select"),A=document.getElementById("tmpl-edit-audio-modal").content.cloneNode(!0).querySelector("audio");A.querySelector("source").src=b,r.querySelector(".wp_audio_shortcode")?r.querySelector(".wp_audio_shortcode").replaceWith(A):r.querySelector(".widget-modal-attachment-info").prepend(A),r.querySelector(".widget-modal-attachment-info .details").style.width="100%",r.querySelector(".alt-text")&&r.querySelector(".alt-text").remove(),r.querySelector("#alt-text-description")&&r.querySelector("#alt-text-description").remove(),r.querySelector(".widget-modal-display-settings")&&(r.querySelector(".widget-modal-display-settings").previousElementSibling.remove(),r.querySelector(".widget-modal-display-settings").remove()),function(e,t){var a=document.createElement("div");a.className="artist-album",a.innerHTML='<div class="setting" data-setting="artist"><label for="attachment-details-artist" class="name">'+AUDIO_WIDGET.artist+'</label><input type="text" id="attachment-details-artist" value="'+e+'"></div><div class="setting" data-setting="album"><label for="attachment-details-album" class="name">'+AUDIO_WIDGET.album+'</label><input type="text" id="attachment-details-album" value="'+t+'"></div>',null!=document.querySelector(".artist-album")&&document.querySelector(".artist-album").remove(),document.querySelector(".widget-modal-descriptions .settings-save-status").after(a)}(y,g),function(e){var t=document.createElement("form");t.className="compat-item",t.innerHTML='<input type="hidden" id="menu-order" name="attachments['+e+'][menu_order]" value="0"><p class="media-types media-types-required-info"><span class="required-field-message">Required fields are marked <span class="required">*</span></span></p><div class="setting" data-setting="media_category"><label for="attachments-'+e+'-media_category" style="width:30%;"><span class="alignleft">Media Categories</span></label><input type="text" class="text" id="attachments-'+e+'-media_category" name="attachments['+e+'][media_category]" value=""></div><div class="setting" data-setting="media_post_tag"><label for="attachments-'+e+'-media_post_tag"><span class="alignleft">Media Tags</span></label><input type="text" class="text" id="attachments-'+e+'-media_post_tag" name="attachments['+e+'][media_post_tag]" value=""></div>',null!=document.querySelector(".compat-item")&&document.querySelector(".compat-item").remove(),document.querySelector(".attachment-compat").append(t)}(o),r.querySelector(".attachment-date").textContent=l,r.querySelector(".attachment-filename").textContent=u,r.querySelector("#edit-more").href=ajaxurl.replace("admin-ajax.php","post.php?post="+o+"&action=edit"),r.querySelector("#attachment-details-description").textContent=c,r.querySelector("#attachment-details-copy-link").value=b,!0===i?(r.querySelector("#attachment-details-title").value=n,r.querySelector("#attachment-details-caption").textContent=s):(r.querySelector("#attachment-details-title").value=n,r.querySelector("#attachment-details-caption").textContent=""),v?(h.forEach((function(e){e.removeAttribute("readonly")})),r.querySelector("#edit-more").parentNode.removeAttribute("hidden")):(h.forEach((function(e){e.setAttribute("readonly",!0)})),r.querySelector("#edit-more").parentNode.setAttribute("hidden",!0)),S?(q.forEach((function(e){e.removeAttribute("disabled")})),r.querySelector(".delete-attachment").parentNode.removeAttribute("hidden")):(q.forEach((function(e){e.setAttribute("disabled",!0)})),r.querySelector(".delete-attachment").parentNode.setAttribute("hidden",!0)),r.querySelector("#attachments-"+o+"-media_category").value=m,r.querySelector("#attachments-"+o+"-media_post_tag").value=p,r.querySelector(".widget-modal-right-sidebar-info").removeAttribute("hidden"),r.querySelectorAll(".widget-modal-right-sidebar-info input, .widget-modal-right-sidebar-info textarea").forEach((function(e){e.addEventListener("change",(function(){"compat-item"===e.parentNode.parentNode.className?function(e,t){var a,r,i=new FormData,d=e.getAttribute("name").replace("attachments["+t+"][","").replace("]","");i.append("action","save-attachment-compat"),i.append("nonce",document.getElementById("media-"+t).dataset.updateNonce),i.append("id",t),i.append("taxonomy",d),i.append("attachments["+t+"]["+d+"]",e.value),fetch(ajaxurl,{method:"POST",body:i,credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(i){i.success?("media_category"===d?(r=i.data.media_cats.join(", "),e.value=r,document.getElementById("media-"+t).setAttribute("data-taxes",r)):"media_tag"===d&&(r=i.data.media_tags.join(", "),e.value=r,document.getElementById("media-"+t).setAttribute("data-tags",r)),clearTimeout(a),document.getElementById("tax-saved").classList.remove("hidden"),document.getElementById("tax-saved").setAttribute("aria-hidden","false"),a=setTimeout((function(){document.getElementById("tax-saved").classList.add("hidden"),document.getElementById("tax-saved").setAttribute("aria-hidden","true")}),3e3)):console.error(AUDIO_WIDGET.failed_update,i.data.error)}))["catch"]((function(e){console.error(AUDIO_WIDGET.error,e)}))}(e,o):function(e,t){var a,i=new FormData;i.append("action","save-attachment"),i.append("id",t),i.append("nonce",document.getElementById("media-"+t).dataset.updateNonce),"title"===e.parentNode.dataset.setting?i.append("changes[title]",e.value):"caption"===e.parentNode.dataset.setting||"embed-image-settings-caption"===e.id?i.append("changes[caption]",e.value):"description"===e.parentNode.dataset.setting&&i.append("changes[description]",e.value),fetch(ajaxurl,{method:"POST",body:i,credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(i){var d=r.querySelector("#details-saved");i.success?("title"===e.parentNode.dataset.setting?document.getElementById("media-"+t).setAttribute("aria-label",e.value):"caption"===e.parentNode.dataset.setting?document.getElementById("media-"+t).setAttribute("data-caption",e.value):"description"===e.parentNode.dataset.setting&&document.getElementById("media-"+t).setAttribute("data-description",e.value),clearTimeout(a),d.classList.remove("hidden"),d.setAttribute("aria-hidden","false"),a=setTimeout((function(){d.classList.add("hidden"),d.setAttribute("aria-hidden","true")}),3e3)):console.error(AUDIO_WIDGET.failed_update,i.data.error)}))["catch"]((function(e){console.error(AUDIO_WIDGET.error,e)}))}(e,o)}))})),t.className.includes("selected")?!1===i?(t.querySelector(".check").style.display="block",e.setAttribute("disabled",!0)):(t.classList.remove("selected"),t.setAttribute("aria-checked",!1),t.querySelector(".check").style.display="none",null==document.querySelector(".media-item.selected")&&(e.setAttribute("disabled",!0),r.querySelector(".widget-modal-right-sidebar-info").setAttribute("hidden",!0))):(d&&d.forEach((function(e){e.classList.remove("selected"),e.setAttribute("aria-checked",!1),e.querySelector(".check").style.display="none"})),t.classList.add("selected"),t.setAttribute("aria-checked",!0),t.querySelector(".check").style.display="block",e.removeAttribute("disabled"))}function d(e,t){var a="",r=document.createElement("li");return t.querySelector('[data-property="attachment_id"]')?e.id==t.querySelector('[data-property="attachment_id"]').value&&(a=" selected"):t.querySelector('[data-property="ids"]')&&t.querySelector('[data-property="ids"]').value.split(",").indexOf(e.id).value&&(a=" selected"),r.className="media-item"+a,r.id="media-"+e.id,r.setAttribute("tabindex",0),r.setAttribute("role","checkbox"),r.setAttribute("aria-checked",!!a),r.setAttribute("aria-label",e.title),r.setAttribute("data-id",e.id),r.setAttribute("data-date",e.dateFormatted),r.setAttribute("data-url",e.url),r.setAttribute("data-filename",e.filename),r.setAttribute("data-filetype",e.type),r.setAttribute("data-mime",e.mime),r.setAttribute("data-size",e.filesizeHumanReadable),r.setAttribute("data-caption",e.caption),r.setAttribute("data-description",e.description),r.setAttribute("data-link",e.link),r.setAttribute("data-orientation",e.orientation),r.setAttribute("data-menu-order",e.menuOrder),r.setAttribute("data-taxes",e.media_cats),r.setAttribute("data-tags",e.media_tags),r.setAttribute("data-artist",e.meta.artist),r.setAttribute("data-album",e.meta.album),r.setAttribute("data-update-nonce",e.nonces.update),r.setAttribute("data-delete-nonce",e.nonces["delete"]),r.setAttribute("data-edit-nonce",e.nonces.edit),r.innerHTML='<div class="select-attachment-preview type-'+e.type+" subtype-"+e.subtype+'"><div class="media-thumbnail"><div class="icon"><div class="centered"><img src="'+AUDIO_WIDGET.includes_url+'images/media/audio.png" draggable="false" alt=""></div><div class="filename"><div>'+e.filename+'</div></div></div></div></div><button type="button" class="check" tabindex="-1"><span class="media-modal-icon"></span><span class="screen-reader-text">'+AUDIO_WIDGET.deselect+"></span></button>",r}function o(t,a){var o=r.querySelector("#filter-by-date"),n=o.nextElementSibling,l=r.querySelector("#widget-modal-search-input"),u=new URLSearchParams({action:"query-attachments","query[posts_per_page]":AUDIO_WIDGET.per_page,"query[monthnum]":o.value?parseInt(o.value.substr(4,2),10):0,"query[year]":o.value?parseInt(o.value.substr(0,4),10):0,"query[post_mime_type]":"audio","query[s]":l.value?l.value:"","query[paged]":a||1,"query[media_category_name]":n.value?n.value:""});fetch(ajaxurl,{method:"POST",body:u,credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(o){o.success&&(null===(e=r.querySelector("#media-button-insert"))?e=r.querySelector("#gallery-button-update"):null===e&&(e=r.querySelector("#gallery-button-new")),r.querySelector(".widget-modal-grid").innerHTML="",0===o.data.length?(r.querySelectorAll(".pagination-links button").forEach((function(e){e.setAttribute("data-page",1),e.setAttribute("disabled",!0),e.setAttribute("inert",!0)})),r.querySelector("#current-page-selector").setAttribute("value",1),r.querySelector(".total-pages").textContent=1,r.querySelector(".displaying-num").textContent=document.querySelector(".displaying-num").textContent.replace(/[0-9]+/,0),r.querySelector(".load-more-count").setAttribute("hidden",!0),r.querySelector(".no-media").removeAttribute("hidden")):(o.data.forEach((function(e){var a=d(e,t);r.querySelector(".widget-modal-grid").append(a)})),r.querySelectorAll(".pagination-links button").forEach((function(e){e.className.includes("first-page")||e.className.includes("prev-page")?"1"===a?(e.setAttribute("disabled",!0),e.setAttribute("inert",!0)):(e.removeAttribute("disabled"),e.removeAttribute("inert"),e.className.includes("prev-page")&&(parseInt(a)-1<1?e.setAttribute("data-page",1):e.setAttribute("data-page",parseInt(a)-1))):e.className.includes("next-page")?o.headers.max_pages===parseInt(a)?(e.setAttribute("data-page",a),e.setAttribute("disabled",!0),e.setAttribute("inert",!0)):(e.setAttribute("data-page",parseInt(a)+1),e.removeAttribute("disabled"),e.removeAttribute("inert")):e.className.includes("last-page")&&(e.setAttribute("data-page",o.headers.max_pages),o.headers.max_pages===parseInt(a)?(e.setAttribute("disabled",!0),e.setAttribute("inert",!0)):(e.removeAttribute("disabled"),e.removeAttribute("inert")))})),r.querySelector("#current-page-selector").setAttribute("value",a||1),r.querySelector("#current-page-selector").value=a||1,r.querySelector(".total-pages").textContent=o.headers.max_pages,r.querySelector(".displaying-num").textContent=document.querySelector(".displaying-num").textContent.replace(/[0-9]+/,o.headers.total_posts),null==r.querySelector(".media-item.selected")&&(e.setAttribute("disabled",!0),r.querySelector(".widget-modal-right-sidebar-info").setAttribute("hidden",!0)),r.querySelectorAll(".media-item").forEach((function(e){e.className.includes("selected")&&(i(e,0,!1),e.focus()),e.addEventListener("click",(function(){i(e,0,!0)}))})),r.querySelector(".no-media").setAttribute("hidden",!0),r.querySelector(".load-more-count").removeAttribute("hidden"),r.querySelector(".load-more-count").textContent=o.data.length+" "+AUDIO_WIDGET.of+" "+o.headers.total_posts+" "+AUDIO_WIDGET.media_items))}))["catch"]((function(e){console.error(AUDIO_WIDGET.error,e)})),r.showModal()}function n(t){var a=t.split(".").pop(),i=document.createElement("div"),d=r.querySelector("#message"),o=document.createElement("audio"),n=r.querySelector("#widget-modal-media-content").dataset.widgetId,l=document.getElementById(n);o.src=t,o.onerror=function(){d&&d.remove(),i.id="message",i.className="notice-error is-dismissible",i.innerHTML='<p style="color:#fff;background:red;font-size:1em;padding:0.5em 1em;margin-top:-1px;">'+AUDIO_WIDGET.wrong_url+"</p>",r.querySelector("#widget-modal-embed-url-field").before(i),e.setAttribute("disabled",!0)},l.querySelector('[data-property="url"]').value=t,AUDIO_WIDGET.audio_file_types.includes(a.toLowerCase())?d&&d.remove():(d&&d.remove(),i.id="message",i.className="notice-error",i.innerHTML='<p style="color:#fff;background:red;font-size:16px;padding:0.5em 1em;margin-top:-1px;">'+AUDIO_WIDGET.unsupported_file_type+"</p>",r.querySelector("#widget-modal-embed-url-field").before(i),e.setAttribute("disabled",!0))}function l(){var e,t,a;r.querySelector("#widget-modal-media-content")&&window.innerWidth<901&&((a=r.querySelector("details")).removeAttribute("hidden"),a.addEventListener("toggle",(function(i){i.target.open&&((e=r.querySelector("#menu-item-add")).removeAttribute("hidden"),e.setAttribute("aria-selected",!0),(t=r.querySelector("#menu-item-embed")).removeAttribute("hidden"),a.append(e),a.append(t))})))}function u(){var e=r.querySelector("#menu-item-add");r.close(),r.querySelector(".widget-modal-header-buttons")&&r.querySelector(".widget-modal-header-buttons").remove(),r.querySelector("#widget-modal-media-content")&&r.querySelector("#widget-modal-media-content").remove(),r.querySelector("#audio-modal-content")&&r.querySelector("#audio-modal-content").remove(),r.querySelector(".widget-modal-footer")&&r.querySelector(".widget-modal-footer").remove(),r.querySelector("#menu-item-audio-details")&&r.querySelector("#menu-item-audio-details").remove(),r.removeAttribute("style"),e.textContent=AUDIO_WIDGET.add_media,e.classList.remove("cancel"),e.setAttribute("aria-selected",!0),r.querySelector(".widget-modal-headings").removeAttribute("style"),r.querySelector(".widget-modal-left-sidebar").classList.remove("hidden")}document.addEventListener("click",(function(s){var c,m,p,y,g,b,v,S,h,q,A,f,_,w,I,E,x,D,T,N=s.target.closest(".widget");N?(c=N.querySelector(".id_base"))&&"media_audio"===c.value&&"BUTTON"===s.target.tagName&&(s.target.className.includes("select-media")?function(t){var a=document.getElementById("tmpl-media-grid-modal").content.cloneNode(!0),o=a.querySelector(".widget-modal-header-buttons"),n=a.querySelector("#widget-modal-media-content"),u=r.querySelector("header"),s=new URLSearchParams({action:"query-attachments","query[posts_per_page]":AUDIO_WIDGET.per_page,"query[post_mime_type]":"audio","query[paged]":1});fetch(ajaxurl,{method:"POST",body:s,credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(a){a.success&&(u.append(o),u.after(n),r.querySelector("#menu-item-embed").removeAttribute("hidden"),r.querySelector("#menu-item-add").textContent=AUDIO_WIDGET.add_audio,r.querySelector(".widget-modal-attachment-info .thumbnail-image").remove(),l(),r.querySelector("#widget-modal-media-content").dataset.widgetId=t.id,e=r.querySelector("#media-button-insert"),r.querySelector("#menu-item-browse").click(),0===a.data.length?(r.querySelectorAll(".pagination-links button").forEach((function(e){e.setAttribute("data-page",1),e.setAttribute("disabled",!0),e.setAttribute("inert",!0)})),r.querySelector("#current-page-selector").setAttribute("value",1),r.querySelector(".total-pages").textContent=1,r.querySelector(".displaying-num").textContent=document.querySelector(".displaying-num").textContent.replace(/[0-9]+/,0),r.querySelector(".load-more-count").setAttribute("hidden",!0),r.querySelector(".no-media").removeAttribute("hidden")):(a.data.forEach((function(e){var a=d(e,t);r.querySelector(".widget-modal-grid").append(a)})),r.querySelectorAll(".pagination-links button").forEach((function(e){e.className.includes("next-page")?1!==a.headers.max_pages&&(e.setAttribute("data-page",2),e.removeAttribute("disabled"),e.removeAttribute("inert")):e.className.includes("last-page")&&(e.setAttribute("data-page",a.headers.max_pages),1!==a.headers.max_pages&&(e.removeAttribute("disabled"),e.removeAttribute("inert")))})),r.querySelector(".total-pages").textContent=a.headers.max_pages,r.querySelector(".displaying-num").textContent=document.querySelector(".displaying-num").textContent.replace(/[0-9]+/,a.headers.total_posts),r.querySelectorAll(".media-item").forEach((function(e){e.className.includes("selected")&&i(e,0,!1),e.addEventListener("click",(function(){i(e,0,!0)}))})),r.querySelector(".no-media").setAttribute("hidden",!0),r.querySelector(".load-more-count").removeAttribute("hidden"),r.querySelector(".load-more-count").textContent=a.data.length+" "+AUDIO_WIDGET.of+" "+a.headers.total_posts+" "+AUDIO_WIDGET.media_items))}))["catch"]((function(e){console.error(AUDIO_WIDGET.error,e)})),r.showModal()}(N):s.target.className.includes("edit-media")&&function(e){var t,a,i,d=e.querySelector('[data-property="preload"]').value,o=e.querySelector('[data-property="mp3"]').value,n=e.querySelector('[data-property="ogg"]').value,u=e.querySelector('[data-property="flac"]').value,s=e.querySelector('[data-property="m4a"]').value,c=e.querySelector('[data-property="wav"]').value,m=e.querySelector('[data-property="url"]').value,p=document.getElementById("tmpl-edit-audio-modal").content.cloneNode(!0),y=r.querySelector("#menu-item-add"),g=document.createElement("button");null===m&&(m=o),null===m&&(m=n),null===m&&(m=u),null===m&&(m=s),null===m&&(m=c),null!==m?(r.style.width="85%",r.style.height="85%",(t=r.querySelector("header")).after(p.querySelector("#audio-modal-content")),t.querySelector(".widget-modal-headings").style.padding="0 0.5em 0 0.75em",t.querySelector("#widget-modal-title h2").textContent=AUDIO_WIDGET.audio_details,r.querySelector(".wp_audio_shortcode source").src=m,(i=r.querySelector("#audio-details-source")).value=m,i.previousElementSibling.value=m.split(".").pop().toUpperCase(),y.textContent=AUDIO_WIDGET.cancel_edit,y.classList.add("cancel"),y.classList.remove("active"),y.setAttribute("aria-selected",!1),g.id="menu-item-audio-details",g.className="media-menu-item active",g.type="button",g.role="tab",g.setAttribute("aria-selected",!0),g.textContent=AUDIO_WIDGET.details_button,r.querySelector(".separator").after(g),r.querySelector("#menu-item-embed").setAttribute("hidden",!0),r.querySelector("#audio-modal-content").dataset.widgetId=e.id,r.querySelector(".widget-modal-main").append(p.querySelector("footer")),l(),r.querySelector("#audio-details-loop").checked="1"===e.querySelector('[data-property="loop"]').value,r.showModal(),(a=r.querySelector("#preload")).querySelectorAll("option").forEach((function(e){e.removeAttribute("selected"),e.value===d&&e.setAttribute("selected",!0)})),a.addEventListener("change",(function(){var e=this[this.selectedIndex];a.querySelectorAll("option").forEach((function(e){e.removeAttribute("selected")})),e.setAttribute("selected",!0),r.querySelector("#audio-button-update").disabled=!1})),r.querySelector("#audio-details-loop").addEventListener("change",(function(){r.querySelector("#audio-button-update").disabled=!1})),r.querySelectorAll(".add-media-source").forEach((function(t){var a=t.dataset.mime.split("/").pop();e.querySelector('[data-property="'+a+'"]').value=t.value}))):console.error(AUDIO_WIDGET.no_audio_selected)}(N)):"widget-modal-close"===s.target.id?u():r.querySelector("#audio-modal-content")?(m=r.querySelector("#audio-modal-content").dataset.widgetId,p=document.getElementById(m),"audio-button-update"===s.target.id?function(e){null==r.querySelector("#audio-modal-content audio")?(e.querySelector('[data-property="url"]').value="",e.querySelector('[data-property="preload"]').value="none",e.querySelector('[data-property="loop"]').value="",e.querySelector(".wp_audio_shortcode")?e.querySelector(".wp_audio_shortcode").remove():e.querySelector(".wp-audio-shortcode").remove(),e.querySelector(".media_audio").classList.remove("populated"),e.querySelector(".reset_widget").value="1"):(e.querySelector('[data-property="url"]').value=r.querySelector("#audio-details-source").value,e.querySelector('[data-property="preload"]').value=r.querySelector("#preload").value,e.querySelector('[data-property="loop"]').value=r.querySelector("#audio-details-loop").checked?"1":""),document.body.className.includes("widgets-php")&&e.classList.add("widget-dirty"),e.querySelector(".widget-control-save").textContent=AUDIO_WIDGET.save,e.dispatchEvent(new Event("change")),e.querySelector(".widget-control-save").disabled=!1,u()}(p):"media-menu-item cancel"===s.target.className?u():"button-link remove-setting"===s.target.className&&(s.target.previousElementSibling.remove(),s.target.parentNode.querySelector("audio").remove(),s.target.remove(),r.querySelector("#audio-button-update").disabled=!1)):r.querySelector("#widget-modal-media-content")&&(m=r.querySelector("#widget-modal-media-content").dataset.widgetId,(c=(p=document.getElementById(m)).querySelector(".id_base"))&&"media_audio"===c.value&&(y=r.querySelector("#menu-item-add"),g=r.querySelector("#menu-item-embed"),b=r.querySelector("#menu-item-browse"),v=r.querySelector("#menu-item-upload"),S=r.querySelector("#media-library-grid"),f=r.querySelector(".widget-modal-right-sidebar"),_=r.querySelector(".widget-modal-pages"),h=r.querySelector("#uploader-inline"),q=r.querySelector("#insert-from-url-panel"),A=r.querySelector(".widget-modal-header-buttons"),"pagination-links"===s.target.parentNode.className&&"BUTTON"===s.target.tagName?o(p,s.target.dataset.page):s.target.parentNode.parentNode&&"pagination-links"===s.target.parentNode.parentNode.className&&"BUTTON"===s.target.parentNode.tagName?o(p,s.target.parentNode.dataset.page):"menu-item-embed"===s.target.id?(r.querySelector("h2").textContent=AUDIO_WIDGET.insert_from_url,y.classList.remove("active"),y.setAttribute("aria-selected",!1),b.classList.remove("active"),b.setAttribute("aria-selected",!1),v.classList.remove("active"),v.setAttribute("aria-selected",!1),s.target.classList.add("active"),s.target.setAttribute("aria-selected",!0),A.style.display="none",h.setAttribute("hidden",!0),h.setAttribute("hidden",!0),S.setAttribute("hidden",!0),S.setAttribute("inert",!0),f.setAttribute("hidden",!0),q.removeAttribute("hidden"),q.removeAttribute("inert"),function(){var t=r.querySelector("#widget-modal-embed-url-field"),a=r.querySelector("#widget-modal-media-content").dataset.widgetId,i=document.getElementById(a).querySelector('[data-property="url"]').value;r.querySelector("#widget-modal-url-settings").style.display="none",t.value=i,""!==i&&n(i),t.addEventListener("change",(function(t){var a=t.target.value,d=r.querySelector("#message");a!==i?(e.removeAttribute("disabled"),n(a)):(d&&d.remove(),e.setAttribute("disabled",!0),a===i&&n(i))}))}()):"menu-item-add"===s.target.id?(r.querySelector("h2").textContent=AUDIO_WIDGET.media_library,g.classList.remove("active"),g.setAttribute("aria-selected",!1),v.classList.remove("active"),v.setAttribute("aria-selected",!1),b.classList.remove("active"),b.setAttribute("aria-selected",!1),q.setAttribute("hidden",!0),q.setAttribute("inert",!0),r.querySelector(".widget-modal-media-embed .thumbnail img")&&r.querySelector(".widget-modal-media-embed .thumbnail img").remove(),A.style.display="flex",S.removeAttribute("hidden"),S.removeAttribute("inert"),f.removeAttribute("hidden"),r.querySelector("#menu-item-browse").click()):"menu-item-browse"===s.target.id?(v.classList.remove("active"),v.setAttribute("aria-selected",!1),y.classList.add("active"),y.setAttribute("aria-selected",!0),g.classList.remove("active"),g.setAttribute("aria-selected",!1),s.target.classList.add("active"),s.target.setAttribute("aria-selected",!0),h.setAttribute("hidden",!0),h.setAttribute("inert",!0),S.removeAttribute("hidden"),S.removeAttribute("inert"),f.removeAttribute("hidden"),f.removeAttribute("inert"),_.removeAttribute("hidden"),_.removeAttribute("inert")):"menu-item-upload"===s.target.id?(b.classList.remove("active"),b.setAttribute("aria-selected",!1),y.classList.remove("active"),y.setAttribute("aria-selected",!1),g.classList.remove("active"),g.setAttribute("aria-selected",!1),s.target.classList.add("active"),s.target.setAttribute("aria-selected",!0),h.removeAttribute("hidden"),h.removeAttribute("inert"),S.setAttribute("hidden",!0),S.setAttribute("inert",!0),f.setAttribute("hidden",!0),f.setAttribute("inert",!0),_.setAttribute("hidden",!0),_.setAttribute("inert",!0),function(e){a.registerPlugin(FilePondPluginFileValidateSize,FilePondPluginFileValidateType,FilePondPluginFileRename,FilePondPluginImagePreview),t=a.create(r.querySelector("#filepond"),{allowMultiple:!0,server:{process:function(e,t,a,r,i,d,o){var n=new FormData;return n.append("async-upload",t,t.name),n.append("action","upload-attachment"),n.append("_wpnonce",document.getElementById("_wpnonce").value),fetch(ajaxurl,{method:"POST",body:n,credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(e){e.success?r("finished"):i(AUDIO_WIDGET.upload_failed)}))["catch"]((function(e){i(AUDIO_WIDGET.upload_failed),console.error(AUDIO_WIDGET.error,e)})),{abort:function(){o()}}},maxFileSize:r.querySelector("#ajax-url").dataset.maxFileSize},onprocessfile:(e,a)=>{e||(setTimeout((function(){t.removeFile(a.id)}),100),function(){var e,t=document.querySelectorAll(".media-item"),a=document.querySelector(".displaying-num").textContent.split(" "),r=document.querySelector(".load-more-count").textContent.split(" ");t.forEach((function(e,t){e.setAttribute("data-order",parseInt(t+1))})),e=5 in r?" "+r[5]:"";document.querySelector(".load-more-count").textContent=r[0]+" "+t.length+" "+r[2]+" "+t.length+" "+r[4]+e,document.querySelector(".displaying-num").textContent=t.length+" "+a[1]}())},onprocessfiles:()=>{o(document.getElementById(e),1),r.querySelector("#menu-item-browse").click(),setTimeout((function(){r.querySelector(".widget-modal-right-sidebar-info").setAttribute("hidden",!0)}),500)},labelTapToUndo:AUDIO_WIDGET.tap_close,fileRenameFunction:e=>new Promise((function(t){t(window.prompt(AUDIO_WIDGET.new_filename,e.name))})),acceptedFileTypes:document.querySelector(".uploader-inline").dataset.allowedMimes.split(","),labelFileTypeNotAllowed:AUDIO_WIDGET.invalid_type,fileValidateTypeLabelExpectedTypes:AUDIO_WIDGET.check_types})}(m)):"media-button-insert"===s.target.id?function(e){var t,a,i="",d=document.createElement("audio"),o=document.createElement("source"),n=document.createElement("fieldset");d.className="wp_audio_shortcode",d.style.width="100%",d.controls=!0,d.setAttribute("draggable",!1),r.querySelector("#insert-from-url-panel").hasAttribute("hidden")?r.querySelector("#media-library-grid").hasAttribute("hidden")||(i=(t=r.querySelector(".widget-modal-grid .selected")).dataset.editNonce,a=t.dataset.url.split(".").pop(),o.src=t.dataset.url,e.querySelector('[data-property="attachment_id"]').value=t.dataset.id):(o.src=r.querySelector("#widget-modal-embed-url-field").value,a=o.src.split(".").pop(),e.querySelector('[data-property="attachment_id"]').value=0),n.className="media-widget-buttons",n.innerHTML='<button type="button" class="button edit-media" data-edit-nonce="'+i+'">'+AUDIO_WIDGET.edit_audio+'</button><button type="button" class="button change-media select-media">'+AUDIO_WIDGET.replace_audio+"</button>",e.querySelector('[data-property="url"]').value=o.src,e.querySelector('[data-property="'+a+'"]').value=o.src,d.append(o),e.querySelector(".media_audio").innerHTML="",e.querySelector(".media_audio").prepend(d),null==e.querySelector(".media-widget-buttons")&&e.querySelector(".media_audio").after(n),document.body.className.includes("widgets-php")&&e.classList.add("widget-dirty"),e.querySelector(".widget-control-save").textContent=AUDIO_WIDGET.save,e.dispatchEvent(new Event("change")),e.querySelector(".widget-control-save").disabled=!1,u()}(p):s.target.className.includes("delete-attachment")?p.querySelector('[data-property="attachment_id"]')&&r.querySelector(".widget-modal-grid .selected").dataset.id!=p.querySelector('[data-property="attachment_id"]').value&&window.confirm(AUDIO_WIDGET.confirm_delete)&&(D=r.querySelector(".widget-modal-grid .selected").dataset.id,T=new URLSearchParams({action:"delete-post",_ajax_nonce:document.getElementById("media-"+D).dataset.deleteNonce,id:D}),fetch(ajaxurl,{method:"POST",body:T,credentials:"same-origin"}).then((function(e){if(e.ok)return e.json();throw new Error(e.status)})).then((function(e){1===e?u():console.log(AUDIO_WIDGET.delete_failed)}))["catch"]((function(e){console.error(AUDIO_WIDGET.error,e)}))):s.target.className.includes("copy-attachment-url")&&(w=s.target,E=r.querySelector("#attachment-details-copy-link").value,x=document.createElement("input"),navigator.clipboard?navigator.clipboard.writeText(E):(document.body.append(x),x.value=E,x.select(),document.execCommand("copy")),clearTimeout(I),w.nextElementSibling.classList.remove("hidden"),x.remove(),I=setTimeout((function(){w.nextElementSibling.classList.add("hidden")}),3e3),wp.a11y.speak(wp.i18n.__("The file URL has been copied to your clipboard")))))})),r.addEventListener("change",(function(e){var t,a,i;r.querySelector("#widget-modal-media-content")&&(t=r.querySelector("#widget-modal-media-content").dataset.widgetId,(i=(a=document.getElementById(t)).querySelector(".id_base"))&&"media_audio"===i.value&&("filter-by-date"===e.target.id||"postform"===e.target.className?o(a,1):"current-page-selector"===e.target.id?o(a,e.target.value):"widget-modal-search-input"===e.target.id&&(o(a,1),r.querySelector(".widget-modal-right-sidebar-info").setAttribute("hidden",!0))))})),r.addEventListener("keydown",(function(e){var t,a,i,d;r.querySelector("#media-widget-modal")&&(r.querySelector("#audio-modal-content")?t=r.querySelector("#audio-modal-content").dataset.widgetId:r.querySelector("#widget-modal-media-content")&&(t=r.querySelector("#widget-modal-media-content").dataset.widgetId),t&&(a=document.getElementById(t),i=a.querySelector("details"),(d=a.querySelector(".id_base"))&&"media_audio"===d.value&&r.open&&"Escape"===e.key&&(u(),setTimeout((function(){i.open=!0}),100),i.addEventListener("toggle",(function(e){e.target.open&&(a.querySelector(".edit-media")?a.querySelector(".edit-media").focus():a.querySelector(".select-media").focus())})))))}))}));